//#SUB
//# COPYRIGHT cXXXXXXXXXX 2009
//##############################################################################
//#                                                                            #
//#      ＜＜　マミーマート様MD基幹システム−商品実績　＞＞                    #
//#                                                                            #
//#　プログラム名　　：　OUTレコードドロップ処理                               #
//#　プログラムＩＤ　：　OutDrop                                               #
//#　版　　　　　数　：　V1.0                                                  #
//#　作　　成　　日　：　2009.03.02                                            #
//#                                                                            #
//#　処理概要　：　対象カーソ以外のレコードを削除する                          #
//#                                                                            #
//#　パラメタ　：                                                              #
//#　　%1　―　テーブル                                                        #
//#　　%2　―　対象集合ID                                                      #
//#                                                                            #
//#　コメント　：　                                                            #
//#                                                                            #
//#　修正履歴：                                                                #
//#　　版数  日付        更新者     内容                                       #
//#　　----  ----------  ---------  -----------------------------------------  #
//#　　V1.0  2009.03.02  田中       新規作成                                   #
//##############################################################################

//##############################################################################
$echo ■ＳＵＢ１．初期処理
//##############################################################################
$ParaSet("%TBL_NAME",%1)
$ParaSet("%CUR_ID",%2)

//##############################################################################
$echo ■ＳＵＢ２．本処理
//##############################################################################

//##########################################################################
$echo ■ＳＵＢ２−１．対象カーソル以外を抽出
//##########################################################################
$SetNOT("%TBL_NAME","%CUR_ID")

//##########################################################################
$echo ■ＳＵＢ２−２．カーソル退避
//##########################################################################
$ParaSet("%DROP_CUR","__SID")

//##########################################################################
$echo ■ＳＵＢ２−３．対象カーソル以外のデータを削除
//##########################################################################
$DeleteRow("%TBL_NAME","1","*","%DROP_CUR")

//##############################################################################
$echo ■ＳＵＢ３．終了処理
//##############################################################################
//#ワークのカーソルを削除
$CursorDelete("%TBL_NAME","%DROP_CUR")
//#対象カーソルも削除→対象カーソル＝「1」になる為
$CursorDelete("%TBL_NAME","%CUR_ID")

